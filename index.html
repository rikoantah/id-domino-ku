<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>ID KU'</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  min-height:100vh;
  background:linear-gradient(180deg,#020617,#0f172a);
  font-family:system-ui;
  color:#e5e7eb;
}

header{
  text-align:center;
  padding:18px;
  font-size:22px;
  font-weight:700;
}

#list{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(130px,1fr));
  gap:12px;
  padding:12px;
}

.item{
  background:#1f2937;
  padding:18px 8px;
  text-align:center;
  border-radius:16px;
  font-weight:600;
  cursor:pointer;
  position:relative;
  transition:.15s;
}

.item:active{
  transform:scale(.96);
}

.item.used{
  background:#064e3b;
  color:#bbf7d0;
}

.item.used::after{
  content:"âœ“";
  position:absolute;
  top:6px;
  right:10px;
  font-size:14px;
  color:#22c55e;
}
</style>
</head>

<body>

<header>ID KU'</header>
<div id="list"></div>

<script>
/* =====================
   KONFIG
===================== */
const CSV_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vTRXU-DQApb_fHnXcXOAIz7ZyQtEpB7G2TXSpee_XqX5zIbj4URA8ckDV4jG49aHT9EJsB1sfNHAgqW/pub?output=csv";

const STORAGE_KEY = "id_ku_used";
const RESET_KEY = "id_ku_reset";

/* =====================
   RESET 00:00
===================== */
function today(){
  return new Date().toISOString().slice(0,10);
}

if(localStorage.getItem(RESET_KEY) !== today()){
  localStorage.setItem(RESET_KEY, today());
  localStorage.removeItem(STORAGE_KEY);
}

let used = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

/* =====================
   LOAD CSV
===================== */
fetch(CSV_URL)
.then(r => r.text())
.then(csv => {
  const rows = csv.split("\n").slice(1); // skip header
  const list = document.getElementById("list");

  rows.forEach(row => {
    const cols = row.split(",");
    if(!cols[1]) return; // kolom B

    const id = cols[1].trim();
    if(!id) return;

    const div = document.createElement("div");
    div.className = "item" + (used.includes(id) ? " used" : "");
    div.textContent = id;

    div.onclick = () => {
      navigator.clipboard.writeText(id);
      if(!used.includes(id)){
        used.push(id);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(used));
        div.classList.add("used");
      }
    };

    list.appendChild(div);
  });
})
.catch(()=>{
  document.getElementById("list").innerHTML =
    "<div style='text-align:center;opacity:.6'>Gagal memuat data</div>";
});
</script>

</body>
</html>
