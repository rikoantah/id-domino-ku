<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>ID KU'</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg1:#020617;
  --bg2:#0f172a;
  --card:#1f2937;
  --used:#064e3b;
  --text:#e5e7eb;
  --accent:#22c55e;
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  background:linear-gradient(180deg,var(--bg1),var(--bg2));
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  color:var(--text);
}

header{
  text-align:center;
  padding:18px 10px;
  font-size:22px;
  font-weight:700;
  letter-spacing:1px;
}

#list{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(130px,1fr));
  gap:12px;
  padding:12px;
}

.item{
  background:var(--card);
  padding:18px 8px;
  text-align:center;
  border-radius:16px;
  font-weight:600;
  position:relative;
  cursor:pointer;
  transition:0.2s;
  box-shadow:0 6px 14px rgba(0,0,0,0.35);
}

.item:active{
  transform:scale(0.96);
  box-shadow:0 0 18px rgba(34,197,94,0.6);
}

.item.used{
  background:var(--used);
  color:#bbf7d0;
}

.item.used::after{
  content:"âœ“";
  position:absolute;
  top:6px;
  right:10px;
  font-size:14px;
  color:var(--accent);
}
</style>
</head>

<body>

<header>ID KU'</header>
<div id="list"></div>

<script>
/* =========================
   KONFIGURASI
========================= */
const SHEET_ID = "1-H7Mr24YJwgBBNq93djB_lCHMzH9I7t1uS8U4DCGPmI";
const SHEET_NAME = "Data";
const STORAGE_KEY = "id_ku_used";
const RESET_KEY = "id_ku_reset";

/* =========================
   RESET JAM 00:00
========================= */
function today(){
  return new Date().toISOString().slice(0,10);
}

function resetIfNeeded(){
  const last = localStorage.getItem(RESET_KEY);
  if(last !== today()){
    localStorage.removeItem(STORAGE_KEY);
    localStorage.setItem(RESET_KEY, today());
  }
}
resetIfNeeded();

/* =========================
   LOAD STATUS
========================= */
let used = JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");

/* =========================
   AMBIL DATA DARI SHEET
========================= */
const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?sheet=${encodeURIComponent(SHEET_NAME)}&tq=select%20B`;

fetch(url)
.then(res => res.text())
.then(text => {
  const json = JSON.parse(text.substring(47).slice(0, -2));
  const rows = json.table.rows;
  const list = document.getElementById("list");

  rows.forEach(r => {
    if(!r.c || !r.c[0] || !r.c[0].v) return;

    const id = r.c[0].v.toString().trim();
    if(!id) return;

    const div = document.createElement("div");
    div.className = "item" + (used.includes(id) ? " used" : "");
    div.textContent = id;

    div.onclick = () => {
      navigator.clipboard.writeText(id);
      if(!used.includes(id)){
        used.push(id);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(used));
        div.classList.add("used");
      }
    };

    list.appendChild(div);
  });
})
.catch(err=>{
  document.getElementById("list").innerHTML =
    "<div style='opacity:.6;text-align:center'>Data tidak dapat dimuat</div>";
});
</script>

</body>
</html>
